{"version":3,"sources":["../../../../node_modules/sanity/src/core/studio/ViteDevServerStopped.tsx"],"sourcesContent":["import {Card, Container, Heading, Stack, Text} from '@sanity/ui'\nimport {type ReactNode, useCallback, useEffect, useState} from 'react'\nimport {type ViteHotContext} from 'vite/types/hot.js'\n\nconst ERROR_TITLE = 'Dev server stopped'\nconst ERROR_DESCRIPTION =\n  'The development server has stopped. You may need to restart it to continue working.'\n\nexport class ViteDevServerStoppedError extends Error {\n  ViteDevServerStoppedError: boolean\n\n  constructor() {\n    super(ERROR_TITLE)\n    this.name = 'ViteDevServerStoppedError'\n    this.ViteDevServerStoppedError = true\n  }\n}\nconst serverHot = import.meta.hot\nconst isViteServer = (hot: unknown): hot is ViteHotContext => Boolean(hot)\n\nconst useDetectViteDevServerStopped = () => {\n  const [devServerStopped, setDevServerStopped] = useState(false)\n\n  const markDevServerStopped = useCallback(() => setDevServerStopped(true), [])\n\n  useEffect(() => {\n    // no early return to optimize tree-shaking\n    if (isViteServer(serverHot)) {\n      serverHot.on('vite:ws:disconnect', markDevServerStopped)\n    }\n  }, [markDevServerStopped])\n\n  return {devServerStopped}\n}\n\nconst ThrowViteServerStopped = () => {\n  const {devServerStopped} = useDetectViteDevServerStopped()\n\n  if (devServerStopped) throw new ViteDevServerStoppedError()\n\n  return null\n}\n\nexport const DetectViteDevServerStopped = (): ReactNode =>\n  isViteServer(serverHot) ? <ThrowViteServerStopped /> : null\n\nexport const DevServerStoppedErrorScreen = (): ReactNode => (\n  <Card\n    height=\"fill\"\n    overflow=\"auto\"\n    paddingY={[4, 5, 6, 7]}\n    paddingX={4}\n    sizing=\"border\"\n    tone=\"critical\"\n  >\n    <Container width={3}>\n      <Stack space={4}>\n        <Heading>{ERROR_TITLE}</Heading>\n\n        <Card border radius={2} overflow=\"auto\" padding={4} tone=\"inherit\">\n          <Stack space={4}>\n            <Text size={2}>{ERROR_DESCRIPTION}</Text>\n          </Stack>\n        </Card>\n      </Stack>\n    </Container>\n  </Card>\n)\n"],"names":["ERROR_TITLE","ERROR_DESCRIPTION","ViteDevServerStoppedError","Error","constructor","name","serverHot","import","hot","isViteServer","Boolean","useDetectViteDevServerStopped","$","_c","devServerStopped","setDevServerStopped","useState","t0","Symbol","for","markDevServerStopped","t1","t2","on","useEffect","t3","ThrowViteServerStopped","DetectViteDevServerStopped","DevServerStoppedErrorScreen"],"mappings":"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"}